<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>SBORPS   &raquo; Code Snippets</title>
<meta name="generator" content="WordPress 3.0.1" /> <!-- leave this for stats -->
<link rel="stylesheet" href="../../wp-content/themes/japanese-bonzai-10/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="SBORPS RSS Feed" href="../../feed/index.html" />
<link rel="pingback" href="../../xmlrpc.php" />
<link rel="alternate" type="application/rss+xml" title="SBORPS &raquo; Code Snippets Category Feed" href="feed/index.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='SBORPS' href='../../index.html' />
<meta name="generator" content="WordPress 3.0.1" />
<script src="../../wp-content/mu-plugins/anarchy_media/anarchy_media_player6526.php?anarchy.js" type="text/javascript"></script><script language="javascript1.4" type="text/javascript" src="../../wp-content/mu-plugins/audio-player/audio-player.js"></script>
	<style type="text/css">
	    /* <![CDATA[ */

#wp-admin-bar { /* The left content */
	    position: relative;
	    z-index: 66;
	    height: 28px; /* changed by dr mike */
	    margin: 0;
	    padding: 2px;
	    background: #f9f9f9;
	    border: 1px solid #666;
			  border-right: none;
	    border-bottom:1px solid #3285ae; /* added by dr mike */
	    font:12px "Lucida Grande","Lucida Sans Unicode",Tahoma,Verdana; /* added by dr mike */
	    color: #fff; /* changed by dr mike */
	    clear: both;
	    text-align: left;
			  float: left;
			  background:url('../../../wp-includes/images/adminbar.png') #14568a no-repeat 40% 0; /* added by dr mike */
}

#wp-admin-bar-right { /* The right content */
	    position: relative;
	    z-index: 66;
	    height: 28px; /* changed by dr mike */
	    margin: 0;
	    padding: 2px;
	    background: #f9f9f9;
	    border: 1px solid #666;
			  border-left: none;
	    border-bottom:1px solid #3285ae; /* added by dr mike */
	    font:12px "Lucida Grande","Lucida Sans Unicode",Tahoma,Verdana; /* added by dr mike */
	    color: #fff; /* changed by dr mike */
	    clear: both;
	    text-align: right;
			  float: right;
			  background:url('../../../wp-includes/images/adminbar.png') #14568a no-repeat 100% 0; /* added by dr mike */
}

body {
	    /* padding-top: 0px; /* this may cause problems */
			padding-top: 28px !important; /* suggested by dsader in
			http://mu.wordpress.org/forums/topic.php?id=9099#post-54428 */
}

	#wp-admin-bar { /* part of hack to make the bar show at the top of all templates */
		position: absolute; /* IE fix thanks Chris */
		top: 0;
		left: 0;
		width: 80%;
	}
	
	#wp-admin-bar-right { /* part of hack to make the bar show at the top of all templates */
		position: absolute; /* IE fix thanks Chris */
		top: 0;
		right: 0;
		width: 20%;
	}

	#wp-admin-bar ul, #wp-admin-bar-right ul {
		margin: 0;
		padding: 0;
		list-style-type: none;
	}

	#wp-admin-bar ul li, #wp-admin-bar-right ul li {
		list-style-type: none;
		display: inline;
		margin: 0 10px;
		padding: 0;
		font:12px "Lucida Grande","Lucida Sans Unicode",Tahoma,Verdana; /* added by dr mike */
		color: #fff; /* changed by dr mike */
	}

	#wp-admin-bar ul li.login, #wp-admin-bar-right ul li.login { margin-right: 30px; }
	#wp-admin-bar strong, #wp-admin-bar-right strong { font-weight: bold; }
	#wp-admin-bar a, #wp-admin-bar-right a { color: #fff; }
	#wp-admin-bar a:hover, #wp-admin-bar-right a:hover { color: #488cff; }

	    /* ]]> */
	    </style>
	<link rel="stylesheet" type="text/css" href="../../wp-content/mu-plugins/wp-recaptcha/recaptcha.css" /><link rel="stylesheet" href="../../wp-content/plugins/ig_syntax_hilite/css/syntax_hilite_css.css" type="text/css" media="all" />
	<script language="javascript" type="text/javascript" src="../../wp-content/plugins/ig_syntax_hilite/js/syntax_hilite_js.js"></script>
	<script language="javascript" type="text/javascript">
	var arrCode = new Array();
	</script>
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
</head>
<body>
<div id="dimensions">
<div id="header">
<div id="title">
<a href="../../index.html">SBORPS</a>
</div>
<div id="description">SilverSpring&#8217;s bunch of random PSP stuff&#8230;</div>
</div>

<div class="left">

	
		
			<div class="post" id="post-44">
				<h2><a href="../../2008/08/sborps-random-fact-04/index.html" rel="bookmark" title="Permanent Link to SBORPS Random Fact 04">SBORPS Random Fact 04</a></h2>
				<small>August 16th, 2008 silverspring </small>

			
					<p>SCE media reports have always stated that the PSP has AES capabilities. These are apparently referring to the fact that the UMD format discs are AES encrypted. This means that SPOCK (the crypto engine responsible for UMD decryption) has AES decryption capabilities. KIRK on the other hand (the main crypto engine responsible for prx/eboot decryption) also has a block cipher but is unknown which algorithm it uses, though it is almost certainly AES as well. Currently what is known about the cipher is that it is:</p>
<ul>
<li>a block cipher operating in CBC mode</li>
<li>an all zero 128-bit initialization vector</li>
<li>128-bit block and key sizes</li>
<li>cmd4/7 uses a static key that is identical in all PSP&#8217;s</li>
<li>cmd5/8 uses a key based off the fuseID making all operations unique per PSP</li>
<li>cmd6/9 uses a user-defined 128-bit key</li>
<li>cmd1/2/3 uses the block cipher but also signature algorithms</li>
<li>the remaining KIRK cmd&#8217;s do not use the block cipher (sig, hash, &#038; prng algo&#8217;s)</li>
</ul>
<p>Interfacing with KIRK for general-purpose encryption is cumbersome and using a software-based lib is both slow and memory-consuming. Fortunately, there is another method: using the MagicGate hardware. The API provides both standard DES and AES algorithms.</p>
<ul>
<li>0x2DAD213D sceMgrDESEncrypt</li>
<li>0xF5DFD97B sceMgrDESDecrypt</li>
<li>0x8A916574 sceMgrAESEncrypt</li>
<li>0x3054F8F1 sceMgrAESDecrypt</li>
</ul>
<p>The prototypes are as follows:</p>
<div class="igBar"><span id="lc-1"><a href="#" onclick="javascript:showPlainTxt('c-1'); return false;">view plain</a></span></div>
<div class="syntax_hilite"><span class="langName">C:</span>
<div id="c-1">
<div class="c" style="font-family: monospace;">
<ol>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">/*</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">dst: &nbsp;output buffer</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">src: &nbsp;input buffer</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">size: input size</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">key: &nbsp;encryption/decryption key (64-bit for DES, 128-bit for AES)</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">iv: &nbsp; initialization vector for CBC mode (pass NULL for ECB mode) (64-bit for DES, 128-bit for AES)</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">*/</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #2E8B57;">int</span> sceMgrDESEncrypt<span style="color: red;">&#40;</span>u8 *dst, u8 *src, <span style="color: #2E8B57;">int</span> size, u8 *key, u8 *iv<span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #2E8B57;">int</span> sceMgrDESDecrypt<span style="color: red;">&#40;</span>u8 *dst, u8 *src, <span style="color: #2E8B57;">int</span> size, u8 *key, u8 *iv<span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #2E8B57;">int</span> sceMgrAESEncrypt<span style="color: red;">&#40;</span>u8 *dst, u8 *src, <span style="color: #2E8B57;">int</span> size, u8 *key, u8 *iv<span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #2E8B57;">int</span> sceMgrAESDecrypt<span style="color: red;">&#40;</span>u8 *dst, u8 *src, <span style="color: #2E8B57;">int</span> size, u8 *key, u8 *iv<span style="color: red;">&#41;</span>;</div>
</li>
</ol>
</div>
</div>
</div>
<p></p>


				<p class="postmetadata">Posted in <a href="index.html" title="View all posts in Code Snippets" rel="category tag">Code Snippets</a>, <a href="../nids/index.html" title="View all posts in NID&#039;s" rel="category tag">NID's</a>, <a href="../random-facts/index.html" title="View all posts in Random Facts" rel="category tag">Random Facts</a> |   <a href="../../2008/08/sborps-random-fact-04/index.html#comments" title="Comment on SBORPS Random Fact 04">4 Comments &#187;</a></p>
			</div>

		
			<div class="post" id="post-37">
				<h2><a href="../../2008/06/scehvauth_library/index.html" rel="bookmark" title="Permanent Link to sceHVAuth_Library">sceHVAuth_Library</a></h2>
				<small>June 20th, 2008 silverspring </small>

			
					<p>Some new nids:</p>
<ul>
<li>0x5e335df6 sceHVAuthOpen</li>
<li>0x816a5f92 sceHVAuthAuth</li>
<li>0x9db7de7c sceHVAuthClose</li>
</ul>
<p>The sceHVAuth lib seems to be used for proxy config settings for the Html Viewer.</p>
<div class="igBar"><span id="lc-2"><a href="#" onclick="javascript:showPlainTxt('c-2'); return false;">view plain</a></span></div>
<div class="syntax_hilite"><span class="langName">C:</span>
<div id="c-2">
<div class="c" style="font-family: monospace;">
<ol>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">/*</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">Creates an 80 char alphanumeric password</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">(randomly generated via a time-seeded Mersenne Twister)</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">*/</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #2E8B57;">int</span> sceHVAuthOpen<span style="color: red;">&#40;</span><span style="color: #2E8B57;">char</span> *pass<span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">/*</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">Verifies the password.</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">hmac is 20-Byte SHA1 HMAC in ascii format</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">*/</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #2E8B57;">int</span> sceHVAuthAuth<span style="color: red;">&#40;</span><span style="color: #2E8B57;">char</span> *pass, <span style="color: #2E8B57;">const</span> <span style="color: #2E8B57;">char</span> *hmac<span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">/*</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">Clears the password</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">*/</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #2E8B57;">int</span> sceHVAuthClose<span style="color: red;">&#40;</span><span style="color: #2E8B57;">char</span> *pass<span style="color: red;">&#41;</span>;</div>
</li>
</ol>
</div>
</div>
</div>
<p></p>


				<p class="postmetadata">Posted in <a href="index.html" title="View all posts in Code Snippets" rel="category tag">Code Snippets</a>, <a href="../nids/index.html" title="View all posts in NID&#039;s" rel="category tag">NID's</a> |   <a href="../../2008/06/scehvauth_library/index.html#comments" title="Comment on sceHVAuth_Library">1 Comment &#187;</a></p>
			</div>

		
			<div class="post" id="post-29">
				<h2><a href="../../2008/04/nand-set_encryption_seed-nid/index.html" rel="bookmark" title="Permanent Link to NAND set_encryption_seed NID (last remaining sceNand nid)">NAND set_encryption_seed NID (last remaining sceNand nid)</a></h2>
				<small>April 11th, 2008 silverspring </small>

			
					<p>Sometimes it&#8217;s the most obvious names that are the hardest to guess (as was also the case with sceSysconBatteryReadNVM):</p>
<p><strong>0x0BEE8F36 sceNandSetScramble</strong></p>
<p>That finally completes the sceNand lib !!</p>
<p>This is used to set the encryption seed for lfat decryption (on 3.00+) and for idstorage (on slim). After correctly setting the seed, all (per-page) reads to the nand will be read decrypted (otherwise raw reads to the nand will just return rubbish).</p>
<p>So, how to calculate the correct seed? For slim idstorage area it is pretty straightforward:</p>
<div class="igBar"><span id="lc-3"><a href="#" onclick="javascript:showPlainTxt('c-3'); return false;">view plain</a></span></div>
<div class="syntax_hilite"><span class="langName">C:</span>
<div id="c-3">
<div class="c" style="font-family: monospace;">
<ol>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">u32 magic;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">u32 buf<span style="color: red;">&#91;</span><span style="color: #cc66cc;color:#800000;">4</span><span style="color: red;">&#93;</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">u32 sha<span style="color: red;">&#91;</span><span style="color: #cc66cc;color:#800000;">5</span><span style="color: red;">&#93;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">buf<span style="color: red;">&#91;</span><span style="color: #cc66cc;color:#800000;">0</span><span style="color: red;">&#93;</span> = *<span style="color: red;">&#40;</span>vu32*<span style="color: red;">&#41;</span><span style="color: red;">&#40;</span>0xBC100090<span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">buf<span style="color: red;">&#91;</span><span style="color: #cc66cc;color:#800000;">1</span><span style="color: red;">&#93;</span> = *<span style="color: red;">&#40;</span>vu32*<span style="color: red;">&#41;</span><span style="color: red;">&#40;</span>0xBC100094<span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">buf<span style="color: red;">&#91;</span><span style="color: #cc66cc;color:#800000;">2</span><span style="color: red;">&#93;</span> = *<span style="color: red;">&#40;</span>vu32*<span style="color: red;">&#41;</span><span style="color: red;">&#40;</span>0xBC100090<span style="color: red;">&#41;</span>&lt;&lt;<span style="color: #cc66cc;color:#800000;">1</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">buf<span style="color: red;">&#91;</span><span style="color: #cc66cc;color:#800000;">3</span><span style="color: red;">&#93;</span> = 0xD41D8CD9;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">sceKernelUtilsSha1Digest<span style="color: red;">&#40;</span><span style="color: red;">&#40;</span>u8*<span style="color: red;">&#41;</span>buf, <span style="color: #2E8B57;">sizeof</span><span style="color: red;">&#40;</span>buf<span style="color: red;">&#41;</span>, <span style="color: red;">&#40;</span>u8*<span style="color: red;">&#41;</span>sha<span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">magic = <span style="color: red;">&#40;</span>sha<span style="color: red;">&#91;</span><span style="color: #cc66cc;color:#800000;">0</span><span style="color: red;">&#93;</span> ^ sha<span style="color: red;">&#91;</span><span style="color: #cc66cc;color:#800000;">3</span><span style="color: red;">&#93;</span><span style="color: red;">&#41;</span> + sha<span style="color: red;">&#91;</span><span style="color: #cc66cc;color:#800000;">2</span><span style="color: red;">&#93;</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">sceNandSetScramble<span style="color: red;">&#40;</span>magic<span style="color: red;">&#41;</span>;</div>
</li>
</ol>
</div>
</div>
</div>
<p></p>
<p>The 64bits stored at hardware register 0xBC100090 is unique for every psp (it is some sort of id or serial). Hence why nand dumps are also unique between psps (for 3.00 onwards).</p>
<p>For lfat area, things get slightly more complicated to derive the correct seed however is still based on the unique 0xBC100090 register. Maybe will come later then we&#8217;ll finally have a logical restore for slims (instead of a relatively dangerous physical restore).</p>


				<p class="postmetadata">Posted in <a href="index.html" title="View all posts in Code Snippets" rel="category tag">Code Snippets</a>, <a href="../nids/index.html" title="View all posts in NID&#039;s" rel="category tag">NID's</a> |   <a href="../../2008/04/nand-set_encryption_seed-nid/index.html#respond" title="Comment on NAND set_encryption_seed NID (last remaining sceNand nid)">No Comments &#187;</a></p>
			</div>

		
			<div class="post" id="post-28">
				<h2><a href="../../2008/04/umd-firmware-version-checker/index.html" rel="bookmark" title="Permanent Link to UMD Firmware Version checker">UMD Firmware Version checker</a></h2>
				<small>April 2nd, 2008 silverspring </small>

			
					<p>Here&#8217;s a quick &#038; dirty sample to dump some info regarding your UMD Firmware.</p>
<p><a href="http://silverspring.lan.st/umd_ver_check.rar">http://silverspring.lan.st/umd_ver_check.rar</a></p>
<p>It&#8217;s a 3.xx app (source included), works on both slim &#038; fat.</p>
<p>Will dump a file called umd.bin into root of MS.</p>
<p>In it will say something like:</p>
<p>SCEI    UMD ROM DRIVE       1.090 Oct18 ,2004</p>
<p>Your UMD FW version will be <em>at least</em> 1.090 or above <em>unless</em> you have an early batch 1.00 JP model <strong>AND</strong> you have never used an official SCE updater (note: downgrading your normal psp fw version wont downgrade the umd fw version &#8211; so downgrading back to 1.00 wont work).</p>
<p>For another reference, here is one from pretty recent JP slim (came with 3.72): </p>
<p>SCEI    UMD ROM DRIVE       1.240 Nov10 ,2006</p>
<p>Also there are a few numbers before this string appears but I couldnt figure out what they represented.</p>
<p>EDIT:</p>
<p>Ok, so the data is just in the standard ATAPI INQUIRY data format.</p>
<p>So:<br />
- the drive reports to the host as a &#8220;CDROM Device&#8221; (0&#215;5 in the Device Type field).<br />
- that the medium is removable (RMB bit set to 1).<br />
- is not standard in either ANSI/ECMA/ISO (all set to 0)<br />
- Response Data Format (2)<br />
- ATAPI Transport Version (3)<br />
- Vendor ID is &#8220;SCEI&#8221;<br />
- Product ID is &#8220;UMD ROM DRIVE&#8221;<br />
- a blank Product Revision Level<br />
- Vendor Specific info &#8220;1.240 Nov10 ,2006&#8243;</p>


				<p class="postmetadata">Posted in <a href="index.html" title="View all posts in Code Snippets" rel="category tag">Code Snippets</a> |   <a href="../../2008/04/umd-firmware-version-checker/index.html#respond" title="Comment on UMD Firmware Version checker">No Comments &#187;</a></p>
			</div>

		
			<div class="post" id="post-20">
				<h2><a href="../../2007/12/380-and-pandora/index.html" rel="bookmark" title="Permanent Link to 3.80 and Pandora">3.80 and Pandora</a></h2>
				<small>December 19th, 2007 silverspring </small>

			
					<p>Well it looks like SCE have finally learned and have now removed the functions to read/write to the battery eeprom in 3.80 (they also took out the sceSysconBatteryAuth function too). So you can&#8217;t make a magic battery with 3.80, but nevermind, the hardware to do so is still there.</p>
<p>Here&#8217;s a compatible replacement:</p>
<div class="igBar"><span id="lc-4"><a href="#" onclick="javascript:showPlainTxt('c-4'); return false;">view plain</a></span></div>
<div class="syntax_hilite"><span class="langName">C:</span>
<div id="c-4">
<div class="c" style="font-family: monospace;">
<ol>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #2E8B57;">int</span> write_eeprom<span style="color: red;">&#40;</span>u8 addr, u16 data<span style="color: red;">&#41;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: red;">&#123;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #2E8B57;">int</span> res;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; u8 param<span style="color: red;">&#91;</span>0&#215;60<span style="color: red;">&#93;</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #5697D9;">if</span> <span style="color: red;">&#40;</span>addr&gt;0x7F<span style="color: red;">&#41;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #5697D9;">return</span><span style="color: red;">&#40;</span>0&#215;80000102<span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; param<span style="color: red;">&#91;</span>0x0C<span style="color: red;">&#93;</span> = 0&#215;73; <span style="color: #4EA73B; font-style: italic;">// write battery eeprom command</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; param<span style="color: red;">&#91;</span>0x0D<span style="color: red;">&#93;</span> = <span style="color: #cc66cc;color:#800000;">5</span>; <span style="color: #4EA73B; font-style: italic;">// tx packet length</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #4EA73B; font-style: italic;">// tx data</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; param<span style="color: red;">&#91;</span>0x0E<span style="color: red;">&#93;</span> = addr;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; param<span style="color: red;">&#91;</span>0x0F<span style="color: red;">&#93;</span> = data;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; param<span style="color: red;">&#91;</span>0&#215;10<span style="color: red;">&#93;</span> = data&gt;&gt;<span style="color: #cc66cc;color:#800000;">8</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; res = sceSysconCmdExec<span style="color: red;">&#40;</span>param, <span style="color: #cc66cc;color:#800000;">0</span><span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #5697D9;">if</span> <span style="color: red;">&#40;</span>res&lt;<span style="color: #cc66cc;color:#800000;">0</span><span style="color: red;">&#41;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #5697D9;">return</span><span style="color: red;">&#40;</span>res<span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #5697D9;">return</span> <span style="color: #cc66cc;color:#800000;">0</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: red;">&#125;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #2E8B57;">int</span> read_eeprom<span style="color: red;">&#40;</span>u8 addr<span style="color: red;">&#41;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: red;">&#123;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #2E8B57;">int</span> res;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; u8 param<span style="color: red;">&#91;</span>0&#215;60<span style="color: red;">&#93;</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #5697D9;">if</span> <span style="color: red;">&#40;</span>addr&gt;0x7F<span style="color: red;">&#41;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #5697D9;">return</span><span style="color: red;">&#40;</span>0&#215;80000102<span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; param<span style="color: red;">&#91;</span>0x0C<span style="color: red;">&#93;</span> = 0&#215;74; <span style="color: #4EA73B; font-style: italic;">// read battery eeprom command</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; param<span style="color: red;">&#91;</span>0x0D<span style="color: red;">&#93;</span> = <span style="color: #cc66cc;color:#800000;">3</span>; <span style="color: #4EA73B; font-style: italic;">// tx packet length</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #4EA73B; font-style: italic;">// tx data</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; param<span style="color: red;">&#91;</span>0x0E<span style="color: red;">&#93;</span> = addr;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; res = sceSysconCmdExec<span style="color: red;">&#40;</span>param, <span style="color: #cc66cc;color:#800000;">0</span><span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #5697D9;">if</span> <span style="color: red;">&#40;</span>res&lt;<span style="color: #cc66cc;color:#800000;">0</span><span style="color: red;">&#41;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #5697D9;">return</span><span style="color: red;">&#40;</span>res<span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #4EA73B; font-style: italic;">// rx data</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #5697D9;">return</span><span style="color: red;">&#40;</span><span style="color: red;">&#40;</span>param<span style="color: red;">&#91;</span>0&#215;21<span style="color: red;">&#93;</span>&lt;&lt;<span style="color: #cc66cc;color:#800000;">8</span><span style="color: red;">&#41;</span> | param<span style="color: red;">&#91;</span>0&#215;20<span style="color: red;">&#93;</span><span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: red;">&#125;</span></div>
</li>
</ol>
</div>
</div>
</div>
<p></p>
<p>EDIT:<br />
Finally cracked the real names:</p>
<p>0x68ef0bef sceSysconBatteryReadNVM<br />
0x1165c864 sceSysconBatteryWriteNVM</p>


				<p class="postmetadata">Posted in <a href="index.html" title="View all posts in Code Snippets" rel="category tag">Code Snippets</a> |   <a href="../../2007/12/380-and-pandora/index.html#comments" title="Comment on 3.80 and Pandora">6 Comments &#187;</a></p>
			</div>

		
			<div class="post" id="post-13">
				<h2><a href="../../2007/11/idstorage-keys-0x0004-0x0008-generating-hash/index.html" rel="bookmark" title="Permanent Link to Idstorage Keys (0&#215;0004-0&#215;0008) &#8211; Generating hash">Idstorage Keys (0&#215;0004-0&#215;0008) &#8211; Generating hash</a></h2>
				<small>November 5th, 2007 silverspring </small>

			
					<p>The idstorage area stores low level info on the PSP. Keys 4-8 are used for config data for various components (the battery, clock generator, LCD, etc.) and are in a different format to all the other keys.</p>
<p>Here is the code to generate the hash for these particular keys:</p>
<div class="igBar"><span id="lc-5"><a href="#" onclick="javascript:showPlainTxt('c-5'); return false;">view plain</a></span></div>
<div class="syntax_hilite"><span class="langName">C:</span>
<div id="c-5">
<div class="c" style="font-family: monospace;">
<ol>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">/*</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">Idstorage Leaf Hash Gen Sample &#8211; SilverSpring 2007</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">The idstorage area stores low level info on the PSP.</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">Keys 4-8 are used for config data for various components</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">(the battery, clock generator, LCD, etc.)</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">and are in a different format to all the other keys.</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">Specifically the format is as follows:</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">typedef struct</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">{</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">&nbsp; &nbsp; u32 signature;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">&nbsp; &nbsp; int type;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">&nbsp; &nbsp; int datalen;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">&nbsp; &nbsp; u32 hash;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">&nbsp; &nbsp; u8 databuf[0x1F0];</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">} SceIdStorageLeaf;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">Here&#8217;s the code to regenerate the hash for those keys.</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">*/</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B;">#include &lt;stdio.h&gt;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B;">#define POLY (0xEDB88320)</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B;">#define LEAF_0x0004_HASH &nbsp; &nbsp;(0x1FAB01BB)</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B;">#define LEAF_DATA_SIZE &nbsp;(0x1F0)</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #2E8B57;">unsigned</span> <span style="color: #2E8B57;">int</span> gen_hash<span style="color: red;">&#40;</span><span style="color: #2E8B57;">unsigned</span> <span style="color: #2E8B57;">int</span> seed, <span style="color: #2E8B57;">unsigned</span> <span style="color: #2E8B57;">char</span> buf<span style="color: red;">&#91;</span><span style="color: red;">&#93;</span>, <span style="color: #2E8B57;">int</span> size<span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #2E8B57;">void</span> gen_table<span style="color: red;">&#40;</span><span style="color: #2E8B57;">void</span><span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #2E8B57;">unsigned</span> <span style="color: #2E8B57;">int</span> table<span style="color: red;">&#91;</span><span style="color: #cc66cc;color:#800000;">256</span><span style="color: red;">&#93;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #2E8B57;">unsigned</span> <span style="color: #2E8B57;">char</span> leaf_0x0004_data<span style="color: red;">&#91;</span>LEAF_DATA_SIZE<span style="color: red;">&#93;</span> = </div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: red;">&#123;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0xD8, 0&#215;00, 0&#215;24, 0&#215;00, 0&#215;14, 0&#215;31, 0&#215;14, 0&#215;00, 0&#215;94, 0&#215;01, 0&#215;48, 0&#215;00, 0xD8, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, 0&#215;00, </div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: red;">&#125;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #2E8B57;">int</span> main<span style="color: red;">&#40;</span><span style="color: red;">&#41;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: red;">&#123;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #2E8B57;">unsigned</span> <span style="color: #2E8B57;">int</span> hash;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; gen_table<span style="color: red;">&#40;</span><span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; hash = gen_hash<span style="color: red;">&#40;</span>0xFFFFFFFF, leaf_0x0004_data, LEAF_DATA_SIZE<span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #5697D9;">if</span> <span style="color: red;">&#40;</span>hash != LEAF_0x0004_HASH<span style="color: red;">&#41;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <a href="http://www.opengroup.org/onlinepubs/009695399/functions/printf.html"><span style="color: #000066;">printf</span></a><span style="color: red;">&#40;</span><span style="color: #000000;">&quot;error: hash not match <span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <a href="http://www.opengroup.org/onlinepubs/009695399/functions/printf.html"><span style="color: #000066;">printf</span></a><span style="color: red;">&#40;</span><span style="color: #000000;">&quot;leaf_0x0004 hash: 0x%08X&quot;</span>, hash<span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #5697D9;">return</span> <span style="color: #cc66cc;color:#800000;">0</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: red;">&#125;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #2E8B57;">unsigned</span> <span style="color: #2E8B57;">int</span> gen_hash<span style="color: red;">&#40;</span><span style="color: #2E8B57;">unsigned</span> <span style="color: #2E8B57;">int</span> seed, <span style="color: #2E8B57;">unsigned</span> <span style="color: #2E8B57;">char</span> buf<span style="color: red;">&#91;</span><span style="color: red;">&#93;</span>, <span style="color: #2E8B57;">int</span> size<span style="color: red;">&#41;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: red;">&#123;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #2E8B57;">unsigned</span> <span style="color: #2E8B57;">int</span> hash = ~seed;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #2E8B57;">unsigned</span> <span style="color: #2E8B57;">char</span> index;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #2E8B57;">int</span> i;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #5697D9;">for</span> <span style="color: red;">&#40;</span>i=<span style="color: #cc66cc;color:#800000;">0</span>; i!=size; i++<span style="color: red;">&#41;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: red;">&#123;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; index = buf<span style="color: red;">&#91;</span>i<span style="color: red;">&#93;</span> ^ hash;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; hash&gt;&gt;= <span style="color: #cc66cc;color:#800000;">8</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; hash ^= table<span style="color: red;">&#91;</span>index<span style="color: red;">&#93;</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: red;">&#125;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #5697D9;">return</span><span style="color: red;">&#40;</span>~hash<span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: red;">&#125;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #2E8B57;">void</span> gen_table<span style="color: red;">&#40;</span><span style="color: #2E8B57;">void</span><span style="color: red;">&#41;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: red;">&#123;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #2E8B57;">unsigned</span> <span style="color: #2E8B57;">int</span> i, j, x;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #5697D9;">for</span> <span style="color: red;">&#40;</span>i=<span style="color: #cc66cc;color:#800000;">0</span>; i&lt;<span style="color: #cc66cc;color:#800000;">256</span>; i++<span style="color: red;">&#41;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: red;">&#123;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; x = i;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #5697D9;">for</span> <span style="color: red;">&#40;</span>j=<span style="color: #cc66cc;color:#800000;">0</span>; j&lt;<span style="color: #cc66cc;color:#800000;">8</span>; j++<span style="color: red;">&#41;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: red;">&#123;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #5697D9;">if</span> <span style="color: red;">&#40;</span>x &amp; <span style="color: #cc66cc;color:#800000;">1</span><span style="color: red;">&#41;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x = <span style="color: red;">&#40;</span>x&gt;&gt;<span style="color: #cc66cc;color:#800000;">1</span><span style="color: red;">&#41;</span> ^ POLY;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #5697D9;">else</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x = <span style="color: red;">&#40;</span>x&gt;&gt;<span style="color: #cc66cc;color:#800000;">1</span><span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: red;">&#125;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; table<span style="color: red;">&#91;</span>i<span style="color: red;">&#93;</span> = x;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: red;">&#125;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: red;">&#125;</span></div>
</li>
</ol>
</div>
</div>
</div>
<p></p>
<p>Note: this is a PC app (though you could run it on the PSP as well if you wanted).</p>


				<p class="postmetadata">Posted in <a href="index.html" title="View all posts in Code Snippets" rel="category tag">Code Snippets</a> |   <a href="../../2007/11/idstorage-keys-0x0004-0x0008-generating-hash/index.html#respond" title="Comment on Idstorage Keys (0&#215;0004-0&#215;0008) &#8211; Generating hash">No Comments &#187;</a></p>
			</div>

		
			<div class="post" id="post-3">
				<h2><a href="../../2007/10/ipl-decrypt-sample-direct-hw-access/index.html" rel="bookmark" title="Permanent Link to IPL Decrypt Sample (direct HW access)">IPL Decrypt Sample (direct HW access)</a></h2>
				<small>October 9th, 2007 silverspring </small>

			
					<p>Since this place is pretty bare right now here&#8217;s a quick sample I wrote up demonstrating how to access the <strong>KIRK</strong> crypto engine directly to do your decryption. Doing raw hardware access means you dont need to access any of the <strong>SCE</strong> crypto API&#8217;s such as the semaphore lib (<em>memlmd.prx</em>).This is useful for the future since no matter how much <strong>SCE</strong> change the libs, nids, etc. The HW remains the same so it will work in all future firmwares (until new PSP motherboards are developed). Might be useful to add to <strong>PSARDUMPER</strong> since <strong>PSARDUMPER</strong> still rely on the <strong>SCE</strong> crypto libs and <strong>SCE</strong> may change the nids in the future and other stupid stuff like that.</p>
<p>To use just place an encrypted IPL as <strong><em>enc_ipl.bin</em></strong> in the MS root. It&#8217;ll decrypt it and save as it <strong><em>dec_ipl.bin</em></strong>.</p>
<p><strong>NOTE:</strong> the same decryption routine can also decrypt prx&#8217;s, though they need to be setup first before being passed to the crypto engine (ie. the prx header needs to be descrambled with its decryption key first). I might write up a quick sample to do that later.</p>
<p>Anyway, enjoy and I hope you&#8217;ll find this useful&#8230;</p>
<p><strong>EDIT:</strong> <em>this is for 1.50 Kernel</em></p>
<p><em><strong>Download link:</strong> </em><a href="../../files/2007/10/ipl-decrypt-sample.rar" title="IPL Decrypt Sample (direct HW access)">IPL Decrypt Sample (direct HW access)</a></p>
<p><strong><br />
</strong></p>
<p><em><strong>Admin note: The issue with the captcha not working has been fixed. Sorry for any inconvenience caused. -EvilSeph </strong></em></p>


				<p class="postmetadata">Posted in <a href="index.html" title="View all posts in Code Snippets" rel="category tag">Code Snippets</a> |   <a href="../../2007/10/ipl-decrypt-sample-direct-hw-access/index.html#respond" title="Comment on IPL Decrypt Sample (direct HW access)">No Comments &#187;</a></p>
			</div>

		
		<div class="navigation">
			<div class="alignleft"></div>
			<div class="alignright"></div>
		</div>

	
	</div>

<div class="right">

		<ul>
			<li id="pages-2" class="widget widget_pages"><h2 class="widgettitle">Pages</h2>
		<ul>
			<li class="page_item page-item-2 current_page_parent"><a href="../../about/index.html" title="About">About</a></li>
<li class="page_item page-item-81"><a href="../../kirk-crypto-engine/index.html" title="KIRK Crypto Engine">KIRK Crypto Engine</a></li>
<li class="page_item page-item-102"><a href="../../motherboard-ics/index.html" title="Motherboard IC&#8217;s">Motherboard IC&#8217;s</a></li>
<li class="page_item page-item-85"><a href="../../nid-explained/index.html" title="NID Explained">NID Explained</a></li>
<li class="page_item page-item-114"><a href="../../pandora-exploit/index.html" title="Pandora Exploit">Pandora Exploit</a></li>
<li class="page_item page-item-36"><a href="../../psp-glossary/index.html" title="PSP Glossary">PSP Glossary</a></li>
<li class="page_item page-item-84"><a href="../../spock-crypto-engine/index.html" title="SPOCK Crypto Engine">SPOCK Crypto Engine</a></li>
		</ul>
		</li>
<li id="categories-1" class="widget widget_categories"><h2 class="widgettitle">Categories</h2>
		<ul>
	<li class="cat-item cat-item-10 current-cat"><a href="index.html" title="View all posts filed under Code Snippets">Code Snippets</a>
</li>
	<li class="cat-item cat-item-27"><a href="../misc/index.html" title="View all posts filed under Misc">Misc</a>
</li>
	<li class="cat-item cat-item-13"><a href="../nids/index.html" title="View all posts filed under NID&#039;s">NID&#039;s</a>
</li>
	<li class="cat-item cat-item-130"><a href="../random-facts/index.html" title="View all posts filed under Random Facts">Random Facts</a>
</li>
	<li class="cat-item cat-item-12"><a href="../tech-docs/index.html" title="View all posts filed under Tech Docs">Tech Docs</a>
</li>
	<li class="cat-item cat-item-1"><a href="../uncategorized/index.html" title="View all posts filed under Uncategorized">Uncategorized</a>
</li>
		</ul>
</li>
<li id="recent-comments-2" class="widget widget_recent_comments"><h2 class="widgettitle">Recent Comments</h2>
<ul id="recentcomments"><li class="recentcomments"><a href='http://www.blackdevsteam.net/' rel='external nofollow' class='url'>Zer01ne</a> on <a href="../../2008/08/sborps-random-fact-04/comment-page-1/index.html#comment-4604">SBORPS Random Fact 04</a></li><li class="recentcomments"><a href='http://www.blackdevsteam.net/' rel='external nofollow' class='url'>Zer01ne</a> on <a href="../../2008/08/sborps-random-fact-04/comment-page-1/index.html#comment-4448">SBORPS Random Fact 04</a></li><li class="recentcomments">DarkFader on <a href="../../2009/11/sborps-random-fact-07/comment-page-1/index.html#comment-4398">SBORPS Random Fact 07</a></li><li class="recentcomments">billybob on <a href="../../2009/11/sborps-random-fact-08/comment-page-1/index.html#comment-4274">SBORPS Random Fact 08</a></li><li class="recentcomments">Mr_Zero on <a href="../../2008/08/sborps-random-fact-04/comment-page-1/index.html#comment-4271">SBORPS Random Fact 04</a></li></ul></li>
<li id="archives-2" class="widget widget_archive"><h2 class="widgettitle">Archives</h2>
		<ul>
			<li><a href='../../2010/10/index.html' title='October 2010'>October 2010</a></li>
	<li><a href='../../2009/11/index.html' title='November 2009'>November 2009</a></li>
	<li><a href='../../2009/09/index.html' title='September 2009'>September 2009</a></li>
	<li><a href='../../2009/07/index.html' title='July 2009'>July 2009</a></li>
	<li><a href='../../2009/05/index.html' title='May 2009'>May 2009</a></li>
	<li><a href='../../2009/01/index.html' title='January 2009'>January 2009</a></li>
	<li><a href='../../2008/12/index.html' title='December 2008'>December 2008</a></li>
	<li><a href='../../2008/10/index.html' title='October 2008'>October 2008</a></li>
	<li><a href='../../2008/09/index.html' title='September 2008'>September 2008</a></li>
	<li><a href='../../2008/08/index.html' title='August 2008'>August 2008</a></li>
	<li><a href='../../2008/07/index.html' title='July 2008'>July 2008</a></li>
	<li><a href='../../2008/06/index.html' title='June 2008'>June 2008</a></li>
	<li><a href='../../2008/05/index.html' title='May 2008'>May 2008</a></li>
	<li><a href='../../2008/04/index.html' title='April 2008'>April 2008</a></li>
	<li><a href='../../2008/02/index.html' title='February 2008'>February 2008</a></li>
	<li><a href='../../2008/01/index.html' title='January 2008'>January 2008</a></li>
	<li><a href='../../2007/12/index.html' title='December 2007'>December 2007</a></li>
	<li><a href='../../2007/11/index.html' title='November 2007'>November 2007</a></li>
	<li><a href='../../2007/10/index.html' title='October 2007'>October 2007</a></li>
		</ul>
</li>
<li id="linkcat-2" class="widget widget_links"><h2 class="widgettitle">Blogroll</h2>

	<ul class='xoxo blogroll'>
<li><a href="http://lan.st/">lan.st</a></li>
<li><a href="http://pb.malloc.us/">Malloc&#8217;s PasteBin</a></li>
<li><a href="http://twitter.com/SilverSpringPSP">My Twitter</a></li>
<li><a href="http://forums.ps2dev.org/">ps2dev.org</a></li>
<li><a href="http://silverspring.lan.st/">PSP PRX LibDocs</a></li>

	</ul>
</li>

<li id="statistics" class="widget fs_widget"><h2 class="widgettitle">FireStats</h2>

<!-- You can customize the sidebox by playing with your theme css-->
<ul class='firestats_sidebox'> 
	<li>Pages displayed : <b>119316</b></li>
	<li>Unique visitors : <b>60292</b></li>
	<li>Pages displayed in last 24 hours : <b>39</b></li>
	<li>Unique visitors in last 24 hours : <b>22</b></li>
	
</ul><span class='fs_powered_by'><img alt='FireStats icon' src='../../wp-content/plugins/firestats/img/firestats-icon-small.png'/><a href='http://firestats.cc/'>&nbsp;Powered by FireStats</a></span></li>
		</ul>
	</div>


<!--IMPORTANT: PLEASE READ-->
<!--THE TERMS OF USE FOR THIS THEME STATE THAT YOU DO NOT REMOVE THE SPONSOR LINKS IN THE FOOTER-->
<div id="footer"><p>SBORPS is proudly powered by <a href="http://mu.wordpress.org/">WordPress MU</a> on <a href="http://my.malloc.us/">My Malloc.us</a>.<br />
Sponsored by: <a href="http://www.get-payday-loans.org/">Instant Payday Loans</a> | <a href="http://www.farawayfurniture.co.uk/shop/shop.php?c1=Indoor&amp;c2=Dining%20Sets">Oak Dining Sets</a> | <a href="http://www.tottenhamhotspurs.tv/">Tottenham Hotspur</a>
</script><!-- | 96 queries. 0.768 seconds.--> <div id="wp-admin-bar"><ul>
	<li><a href="http://my.malloc.us/">Main Blog</a></li>
	<li><a href="http://my.malloc.us//wp-signup.php">Get a Blog</a></li>
</ul></div><div id="wp-admin-bar-right"><ul>
</ul></div></p></div>
</div>
</body>

<!-- Mirrored from my.malloc.us/silverspring/category/code-snippets/ by HTTrack Website Copier/3.x [XR&CO'2010], Thu, 25 Aug 2011 12:02:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>
