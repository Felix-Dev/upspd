<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>SBORPS   &raquo; Pandora Exploit</title>
<meta name="generator" content="WordPress 3.0.1" /> <!-- leave this for stats -->
<link rel="stylesheet" href="../wp-content/themes/japanese-bonzai-10/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="SBORPS RSS Feed" href="../feed/index.html" />
<link rel="pingback" href="../xmlrpc.php" />
<link rel="alternate" type="application/rss+xml" title="SBORPS &raquo; Pandora Exploit Comments Feed" href="feed/index.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='SBORPS' href='../index.html' />
<link rel='prev' title='Motherboard IC&#8217;s' href='../motherboard-ics/index.html' />
<meta name="generator" content="WordPress 3.0.1" />
<link rel='canonical' href='index.html' />
<script src="../wp-content/mu-plugins/anarchy_media/anarchy_media_player6526.php?anarchy.js" type="text/javascript"></script><script language="javascript1.4" type="text/javascript" src="../wp-content/mu-plugins/audio-player/audio-player.js"></script>
	<style type="text/css">
	    /* <![CDATA[ */

#wp-admin-bar { /* The left content */
	    position: relative;
	    z-index: 66;
	    height: 28px; /* changed by dr mike */
	    margin: 0;
	    padding: 2px;
	    background: #f9f9f9;
	    border: 1px solid #666;
			  border-right: none;
	    border-bottom:1px solid #3285ae; /* added by dr mike */
	    font:12px "Lucida Grande","Lucida Sans Unicode",Tahoma,Verdana; /* added by dr mike */
	    color: #fff; /* changed by dr mike */
	    clear: both;
	    text-align: left;
			  float: left;
			  background:url('../../wp-includes/images/adminbar.png') #14568a no-repeat 40% 0; /* added by dr mike */
}

#wp-admin-bar-right { /* The right content */
	    position: relative;
	    z-index: 66;
	    height: 28px; /* changed by dr mike */
	    margin: 0;
	    padding: 2px;
	    background: #f9f9f9;
	    border: 1px solid #666;
			  border-left: none;
	    border-bottom:1px solid #3285ae; /* added by dr mike */
	    font:12px "Lucida Grande","Lucida Sans Unicode",Tahoma,Verdana; /* added by dr mike */
	    color: #fff; /* changed by dr mike */
	    clear: both;
	    text-align: right;
			  float: right;
			  background:url('../../wp-includes/images/adminbar.png') #14568a no-repeat 100% 0; /* added by dr mike */
}

body {
	    /* padding-top: 0px; /* this may cause problems */
			padding-top: 28px !important; /* suggested by dsader in
			http://mu.wordpress.org/forums/topic.php?id=9099#post-54428 */
}

	#wp-admin-bar { /* part of hack to make the bar show at the top of all templates */
		position: absolute; /* IE fix thanks Chris */
		top: 0;
		left: 0;
		width: 80%;
	}
	
	#wp-admin-bar-right { /* part of hack to make the bar show at the top of all templates */
		position: absolute; /* IE fix thanks Chris */
		top: 0;
		right: 0;
		width: 20%;
	}

	#wp-admin-bar ul, #wp-admin-bar-right ul {
		margin: 0;
		padding: 0;
		list-style-type: none;
	}

	#wp-admin-bar ul li, #wp-admin-bar-right ul li {
		list-style-type: none;
		display: inline;
		margin: 0 10px;
		padding: 0;
		font:12px "Lucida Grande","Lucida Sans Unicode",Tahoma,Verdana; /* added by dr mike */
		color: #fff; /* changed by dr mike */
	}

	#wp-admin-bar ul li.login, #wp-admin-bar-right ul li.login { margin-right: 30px; }
	#wp-admin-bar strong, #wp-admin-bar-right strong { font-weight: bold; }
	#wp-admin-bar a, #wp-admin-bar-right a { color: #fff; }
	#wp-admin-bar a:hover, #wp-admin-bar-right a:hover { color: #488cff; }

	    /* ]]> */
	    </style>
	<link rel="stylesheet" type="text/css" href="../wp-content/mu-plugins/wp-recaptcha/recaptcha.css" /><link rel="stylesheet" href="../wp-content/plugins/ig_syntax_hilite/css/syntax_hilite_css.css" type="text/css" media="all" />
	<script language="javascript" type="text/javascript" src="../wp-content/plugins/ig_syntax_hilite/js/syntax_hilite_js.js"></script>
	<script language="javascript" type="text/javascript">
	var arrCode = new Array();
	</script>
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
</head>
<body>
<div id="dimensions">
<div id="header">
<div id="title">
<a href="../index.html">SBORPS</a>
</div>
<div id="description">SilverSpring&#8217;s bunch of random PSP stuff&#8230;</div>
</div>

	<div class="left">

				<div class="post" id="post-114">
		<h2>Pandora Exploit</h2>
			
				<p><strong>Because of too much misinformation and general speculation this page will be a <em>proper</em> documentation of the Pandora Exploit (same exploit used for CFW).</p>
<p>For now it&#8217;ll just be a straight copy-paste of a post I made on QJ forums (will be updated with more info later):</strong></p>
<p>Yes the block was small enough to bruteforce (hence why you couldnt sign a whole EBOOT, would have to bruteforce the whole thing). The private key wasnt bruteforced though (not that it would matter if it were though, the algorithms are still unknown).</p>
<p>How the decryption works is this, the data is first encrypted and then the encrypted data is signed. When passed to the crypto engine, first it checks the signature and if it&#8217;s valid it will decrypt the data (algorithms for both the encryption &#038; signature are unknown, not that I know of anyway, maybe someone knows&#8230;or not ).</p>
<p>The fake encrypted data is bruteforced to decrypt into your chosen data (to be able to exploit the preipl). And the signature for your fake encrypted data is bruteforced again to make it appear valid in the eyes of the crypto engine so that it will will go ahead and decrypt your fake encrypted data.</p>
<p>The preipl exploit works like this:</p>
<p>First a decrypted ipl block:<br />
0&#215;00: load address<br />
0&#215;04: data size<br />
0&#215;08: entry address<br />
0x0C: checksum of previous block<br />
0&#215;10: data</p>
<p>A typical example might be<br />
0x040F1EA0<br />
0x00000F50<br />
0&#215;00000000<br />
0xB71C6EBA<br />
&#8230;data&#8230;</p>
<p>Which means load 0xF50-byte data to 0x040F1EA0. 0xB71C6EBA is the checksum of the previous block. Then entry address is 0 since it hasnt reached the end yet and there are more blocks to load. Once it has loaded all the ipl blocks the very last block will have entry address of where the whole ipl has been loaded (typically 0x040F0000). And will then jump to that address.</p>
<p>Preipl pseudocode for loading &#038; decrypting the ipl:</p>
<div class="igBar"><span id="lc-1"><a href="#" onclick="javascript:showPlainTxt('c-1'); return false;">view plain</a></span></div>
<div class="syntax_hilite"><span class="langName">C:</span>
<div id="c-1">
<div class="c" style="font-family: monospace;">
<ol>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #2E8B57;">int</span> iplBlockNumber = <span style="color: #cc66cc;color:#800000;">0</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">u32 checksum = <span style="color: #cc66cc;color:#800000;">0</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #4EA73B; font-style: italic;">// load/decrypt all encrypted ipl blocks</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #5697D9;">while</span><span style="color: red;">&#40;</span><span style="color: #cc66cc;color:#800000;">1</span><span style="color: red;">&#41;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: red;">&#123;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #4EA73B; font-style: italic;">// copy an encrypted ipl block to 0xBFD00000-0xBFD01000 (4KB embedded cpu ram)</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #5697D9;">if</span> <span style="color: red;">&#40;</span>LoadIplBlock<span style="color: red;">&#40;</span>iplBlockNumber, block<span style="color: red;">&#41;</span> &lt;<span style="color: #cc66cc;color:#800000;">0</span><span style="color: red;">&#41;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #5697D9;">while</span><span style="color: red;">&#40;</span><span style="color: #cc66cc;color:#800000;">1</span><span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #4EA73B; font-style: italic;">// decrypt the ipl block in place (uh oh&#8230;)</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #5697D9;">if</span> <span style="color: red;">&#40;</span>DecryptIplBlock<span style="color: red;">&#40;</span>block, block<span style="color: red;">&#41;</span><span style="color: red;">&#41;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #5697D9;">while</span><span style="color: red;">&#40;</span><span style="color: #cc66cc;color:#800000;">1</span><span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #4EA73B; font-style: italic;">// first block will have zero as its checksum since there is no previous block (another uh oh&#8230;)</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #5697D9;">if</span> <span style="color: red;">&#40;</span>block-&gt;checksum != checksum<span style="color: red;">&#41;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #5697D9;">while</span><span style="color: red;">&#40;</span><span style="color: #cc66cc;color:#800000;">1</span><span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #4EA73B; font-style: italic;">// load the &#8216;data&#8217; section of the ipl block to the specified address (0x040Fxxxx range)</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #5697D9;">if</span> <span style="color: red;">&#40;</span>block-&gt;loadaddr<span style="color: red;">&#41;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; checksum = memcpy<span style="color: red;">&#40;</span>block-&gt;loadaddr, block-&gt;data, block-&gt;blocksize<span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #4EA73B; font-style: italic;">// reached the end of the ipl, jump to the entry address (0x040F0000)</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #5697D9;">if</span> <span style="color: red;">&#40;</span>block-&gt;entry<span style="color: red;">&#41;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: red;">&#123;</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #4EA73B; font-style: italic;">// clear caches</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; Dcache<span style="color: red;">&#40;</span><span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; Icache<span style="color: red;">&#40;</span><span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #4EA73B; font-style: italic;">// jump to ipl &#8211; do not return</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; block-&gt;entry<span style="color: red;">&#40;</span><span style="color: red;">&#41;</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: red;">&#125;</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; iplBlockNumber++;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: red;">&#125;</span></div>
</li>
</ol>
</div>
</div>
</div>
<p></p>
<p>As the preipl loads the first ipl block (the fake one), it decrypts the block in-place, ie. the decrypted block just overwrites your encrypted block. The fake block only decrypts into four bytes of all 0&#8242;s so it ends up only overwriting the first four bytes of your fake block (with four 0&#8242;s) after decryption.</p>
<p>The fake signed block:</p>
<div class="igBar"><span id="lc-2"><a href="#" onclick="javascript:showPlainTxt('c-2'); return false;">view plain</a></span></div>
<div class="syntax_hilite"><span class="langName">C:</span>
<div id="c-2">
<div class="c" style="font-family: monospace;">
<ol>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #cc66cc;color:#800000;">00000000</span>: <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">01</span> D0 BF <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #cc66cc;color:#800000;">00000010</span>: <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #cc66cc;color:#800000;">00000020</span>: <span style="color: #cc66cc;color:#800000;">52</span> A1 <span style="color: #cc66cc;color:#800000;">05</span> CD 3A <span style="color: #cc66cc;color:#800000;">52</span> <span style="color: #cc66cc;color:#800000;">59</span> <span style="color: #cc66cc;color:#800000;">28</span> 0A D1 <span style="color: #cc66cc;color:#800000;">31</span> F1 BD <span style="color: #cc66cc;color:#800000;">87</span> 2E CC</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #cc66cc;color:#800000;">00000030</span>: <span style="color: #cc66cc;color:#800000;">14</span> DA <span style="color: #cc66cc;color:#800000;">02</span> 2F <span style="color: #cc66cc;color:#800000;">77</span> <span style="color: #cc66cc;color:#800000;">88</span> C7 <span style="color: #cc66cc;color:#800000;">66</span> F3 <span style="color: #cc66cc;color:#800000;">32</span> <span style="color: #cc66cc;color:#800000;">07</span> BD 1A <span style="color: #cc66cc;color:#800000;">08</span> 9E 4C</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #cc66cc;color:#800000;">00000040</span>: <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #cc66cc;color:#800000;">00000050</span>: <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #cc66cc;color:#800000;">00000060</span>: <span style="color: #cc66cc;color:#800000;">01</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #cc66cc;color:#800000;">00000070</span>: <span style="color: #cc66cc;color:#800000;">04</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">10</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #cc66cc;color:#800000;">00000080</span>: <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #cc66cc;color:#800000;">00000090</span>: <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">000000A0: <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">00</span> <span style="color: #cc66cc;color:#800000;">01</span> C6 5F <span style="color: #cc66cc;color:#800000;">74</span> <span style="color: #cc66cc;color:#800000;">12</span></div>
</li>
</ol>
</div>
</div>
</div>
<p></p>
<p>The most important parts to note:<br />
0&#215;20-0x3F is the bruteforced hash signatures<br />
0xA0-0xAF is the bruteforced encrypted data<br />
0&#215;70-0&#215;73 is the size of the decrypted data (only 4 bytes)</p>
<p>A slight flaw in the crypto engine allowed the bruteforce to be performed on a magnitude-times smaller scale than normally required.</p>
<p>After decryption, the preipl thinks the data is now a decrypted ipl block.<br />
So note the first 0&#215;10 bytes:<br />
0&#215;00000000 (load address which was faked to four 0&#8242;s when decrypted)<br />
0&#215;00000000 (size of the block to load, none)<br />
0xBFD00100 (the entry address, the most important part, where your unsigned code is located)<br />
0&#215;00000000 (checksum)</p>
<p>It passes the checksum test (with 0&#215;00000000), it skips the loading of any data (since the loadaddr has been faked to 0&#215;00000000), see&#8217;s the entry address of 0xBFD00100 and thinks it has reached the end of the ipl and so goes jumps to that address (which is where your unsigned code will be).</p>
<p>So that&#8217;s essentially it in a nutshell. But dont let a quick 5 min. summary of the exploit underestimate the enourmous effort involved in bringing it to fruition (as the final product known as Pandora).</p>

				
	
		</div>
				</div>

<div class="right">

		<ul>
			<li id="pages-2" class="widget widget_pages"><h2 class="widgettitle">Pages</h2>
		<ul>
			<li class="page_item page-item-2"><a href="../about/index.html" title="About">About</a></li>
<li class="page_item page-item-81"><a href="../kirk-crypto-engine/index.html" title="KIRK Crypto Engine">KIRK Crypto Engine</a></li>
<li class="page_item page-item-102"><a href="../motherboard-ics/index.html" title="Motherboard IC&#8217;s">Motherboard IC&#8217;s</a></li>
<li class="page_item page-item-85"><a href="../nid-explained/index.html" title="NID Explained">NID Explained</a></li>
<li class="page_item page-item-114 current_page_item"><a href="index.html" title="Pandora Exploit">Pandora Exploit</a></li>
<li class="page_item page-item-36"><a href="../psp-glossary/index.html" title="PSP Glossary">PSP Glossary</a></li>
<li class="page_item page-item-84"><a href="../spock-crypto-engine/index.html" title="SPOCK Crypto Engine">SPOCK Crypto Engine</a></li>
		</ul>
		</li>
<li id="categories-1" class="widget widget_categories"><h2 class="widgettitle">Categories</h2>
		<ul>
	<li class="cat-item cat-item-10"><a href="../category/code-snippets/index.html" title="View all posts filed under Code Snippets">Code Snippets</a>
</li>
	<li class="cat-item cat-item-27"><a href="../category/misc/index.html" title="View all posts filed under Misc">Misc</a>
</li>
	<li class="cat-item cat-item-13"><a href="../category/nids/index.html" title="View all posts filed under NID&#039;s">NID&#039;s</a>
</li>
	<li class="cat-item cat-item-130"><a href="../category/random-facts/index.html" title="View all posts filed under Random Facts">Random Facts</a>
</li>
	<li class="cat-item cat-item-12"><a href="../category/tech-docs/index.html" title="View all posts filed under Tech Docs">Tech Docs</a>
</li>
	<li class="cat-item cat-item-1"><a href="../category/uncategorized/index.html" title="View all posts filed under Uncategorized">Uncategorized</a>
</li>
		</ul>
</li>
<li id="recent-comments-2" class="widget widget_recent_comments"><h2 class="widgettitle">Recent Comments</h2>
<ul id="recentcomments"><li class="recentcomments"><a href='http://www.blackdevsteam.net/' rel='external nofollow' class='url'>Zer01ne</a> on <a href="../2008/08/sborps-random-fact-04/comment-page-1/index.html#comment-4604">SBORPS Random Fact 04</a></li><li class="recentcomments"><a href='http://www.blackdevsteam.net/' rel='external nofollow' class='url'>Zer01ne</a> on <a href="../2008/08/sborps-random-fact-04/comment-page-1/index.html#comment-4448">SBORPS Random Fact 04</a></li><li class="recentcomments">DarkFader on <a href="../2009/11/sborps-random-fact-07/comment-page-1/index.html#comment-4398">SBORPS Random Fact 07</a></li><li class="recentcomments">billybob on <a href="../2009/11/sborps-random-fact-08/comment-page-1/index.html#comment-4274">SBORPS Random Fact 08</a></li><li class="recentcomments">Mr_Zero on <a href="../2008/08/sborps-random-fact-04/comment-page-1/index.html#comment-4271">SBORPS Random Fact 04</a></li></ul></li>
<li id="archives-2" class="widget widget_archive"><h2 class="widgettitle">Archives</h2>
		<ul>
			<li><a href='../2010/10/index.html' title='October 2010'>October 2010</a></li>
	<li><a href='../2009/11/index.html' title='November 2009'>November 2009</a></li>
	<li><a href='../2009/09/index.html' title='September 2009'>September 2009</a></li>
	<li><a href='../2009/07/index.html' title='July 2009'>July 2009</a></li>
	<li><a href='../2009/05/index.html' title='May 2009'>May 2009</a></li>
	<li><a href='../2009/01/index.html' title='January 2009'>January 2009</a></li>
	<li><a href='../2008/12/index.html' title='December 2008'>December 2008</a></li>
	<li><a href='../2008/10/index.html' title='October 2008'>October 2008</a></li>
	<li><a href='../2008/09/index.html' title='September 2008'>September 2008</a></li>
	<li><a href='../2008/08/index.html' title='August 2008'>August 2008</a></li>
	<li><a href='../2008/07/index.html' title='July 2008'>July 2008</a></li>
	<li><a href='../2008/06/index.html' title='June 2008'>June 2008</a></li>
	<li><a href='../2008/05/index.html' title='May 2008'>May 2008</a></li>
	<li><a href='../2008/04/index.html' title='April 2008'>April 2008</a></li>
	<li><a href='../2008/02/index.html' title='February 2008'>February 2008</a></li>
	<li><a href='../2008/01/index.html' title='January 2008'>January 2008</a></li>
	<li><a href='../2007/12/index.html' title='December 2007'>December 2007</a></li>
	<li><a href='../2007/11/index.html' title='November 2007'>November 2007</a></li>
	<li><a href='../2007/10/index.html' title='October 2007'>October 2007</a></li>
		</ul>
</li>
<li id="linkcat-2" class="widget widget_links"><h2 class="widgettitle">Blogroll</h2>

	<ul class='xoxo blogroll'>
<li><a href="http://lan.st/">lan.st</a></li>
<li><a href="http://pb.malloc.us/">Malloc&#8217;s PasteBin</a></li>
<li><a href="http://twitter.com/SilverSpringPSP">My Twitter</a></li>
<li><a href="http://forums.ps2dev.org/">ps2dev.org</a></li>
<li><a href="http://silverspring.lan.st/">PSP PRX LibDocs</a></li>

	</ul>
</li>

<li id="statistics" class="widget fs_widget"><h2 class="widgettitle">FireStats</h2>

<!-- You can customize the sidebox by playing with your theme css-->
<ul class='firestats_sidebox'> 
	<li>Pages displayed : <b>119316</b></li>
	<li>Unique visitors : <b>60292</b></li>
	<li>Pages displayed in last 24 hours : <b>39</b></li>
	<li>Unique visitors in last 24 hours : <b>22</b></li>
	
</ul><span class='fs_powered_by'><img alt='FireStats icon' src='../wp-content/plugins/firestats/img/firestats-icon-small.png'/><a href='http://firestats.cc/'>&nbsp;Powered by FireStats</a></span></li>
		</ul>
	</div>


<!--IMPORTANT: PLEASE READ-->
<!--THE TERMS OF USE FOR THIS THEME STATE THAT YOU DO NOT REMOVE THE SPONSOR LINKS IN THE FOOTER-->
<div id="footer"><p>SBORPS is proudly powered by <a href="http://mu.wordpress.org/">WordPress MU</a> on <a href="http://my.malloc.us/">My Malloc.us</a>.<br />
Sponsored by: <a href="http://www.get-payday-loans.org/">Instant Payday Loans</a> | <a href="http://www.farawayfurniture.co.uk/shop/shop.php?c1=Indoor&amp;c2=Dining%20Sets">Oak Dining Sets</a> | <a href="http://www.tottenhamhotspurs.tv/">Tottenham Hotspur</a>
</script><!-- | 99 queries. 0.689 seconds.--> <div id="wp-admin-bar"><ul>
	<li><a href="http://my.malloc.us/">Main Blog</a></li>
	<li><a href="http://my.malloc.us//wp-signup.php">Get a Blog</a></li>
</ul></div><div id="wp-admin-bar-right"><ul>
</ul></div></p></div>
</div>
</body>

<!-- Mirrored from my.malloc.us/silverspring/pandora-exploit/ by HTTrack Website Copier/3.x [XR&CO'2010], Thu, 25 Aug 2011 12:02:26 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>
